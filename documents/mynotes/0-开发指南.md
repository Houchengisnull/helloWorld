[TOC]



# 需求分析

## 认识需求

对于每一个需求要清楚谁在什么时候在什么地方要对谁做什么。至少符合语文陈述句的三要素。（与《驯服烂代码》第5章不谋而合）

> User Story
>
> As a <role> , I want <goal|desire> so that <benfit>
>
> ​																——《驯服烂代码》 第5章

在这里真的要安利一下这本书《驯服烂代码》

### 谁才是用户？

用户是自以为逻辑严密、对系统设计有非凡天赋、死在流水线上的业务人员，即使是经理级别本质上也只是业务人员。

## 原需求需要简化

- 不要浪费事件在很难使用的需求上
- 需要考虑某些很难实现的需求，需求是用户真正需要的需求吗？

其实以上两点均源于一点——控制发生的事请。

> 经常说好的产品都是抽象能力特别强的，可否用大白话讲一下什么是抽象能力，或者举个具体的例子…
>
> - 初级产品经理：描述发生的事情
>
> 对行为进行观察，形成数据，实现这些行为。
>
> - 中级产品经理：解释发生的事情
>
> 一个好的产品经理，会认识到大多数行为受到一些因素的共同影响。一些因素在个体内部起作用，比如基因构成、智力水平或自尊。而有一些因素在外部作用，如环境变量或情境变量。
>
> 一个好的产品经理，可以通过用ta对用户群体经验的洞察力和前辈们的经验，来解释观察到的现象。
>
> - 高级产品经理：预测将要发生的事请
>
> 对于用户行为进行精确解释，常常能让产品经理对用户未来的行为做出精确的预测。
>
> - 终极产品经理：控制发生的事请
>
> 控制意味着使用户行为发生或者不发生——引发它，维持它，停止它，并且影响它的形式、强度或者发生率。
>
> https://www.pmcaff.com/discuss/index/1000000000154664?from=search

关于这个认识，既来自于自己在工作，在书本或论坛中的思考与总结，也来自线下对一些资历丰富的前辈交流的思考。

当时聊天截图也不在了，也懒得去找，就简单描述下：当时一个小白提出一个对MySQL的优化问题：查询是分多步骤进行更好还是一次查询更好。群中有人回答：如果需要在业务逻辑中分过多步骤进行查询很可能是由于需求的问题。

个人认为大多数人至少在自己不擅长的领域是愚蠢的，对内心真正渴望的也不见得有别人认识的清楚。

需求分析人员便是这样一种人，抽象用户需求，认识到需求核心，告诉他人描述真正能解决问题的需求。

> 有两样东西是无限的，宇宙和人类的愚蠢。 ——爱因斯坦

## 错误案例

- 导入excel

  - 界面：一个按钮
  - 过程：
    - 上传文件
    - 根据文件中字段ABCD处理：
      - 完全匹配->更新
      - 不完全匹配->失败
      - 完全不匹配->新增

  咋一看好像没什么问题，可以做。其实用户在上传文件时，需要更新的数据与需要新增的数据不会在同一个文件中存在，故分成两个功能去实现既避免了业务逻辑层复杂的校验，也明确了那个上传按钮具体功能，降低了用户使用的难度。

  旧员工还好，毕竟这个需求就是他们提的，新来的员工的则总会纠结一下：我更新数据的按钮呢？新增数据的按钮呢？是不是这个上传按钮？不会出现什么问题吧？

  所以说不能由着用户来。妈蛋老板和组长还说需求好，那个部门的人大多IT出身。而且在结合整个系统需求后，**这个功能点与整体是有冲突的**（经测试人员提出，可见团队中存在沟通问题，开发时我并不知道系统整体需求，而了解全项目需求的人并无能力分析需求）。

  要想一想，如果有这么一个按钮，我只需要按一下就能达成我所有的愿望，抱歉我实现不了。

# 产品设计

- 产品需要考虑没有因特网的时场景，比如Gradle没有因特网时真的就很麻烦了，它将名称根据神秘算法编码以致于把库文件拷贝到另外一台计算机后无法解析。

## Details

### 表单验证

#### 后端检查重于前端检查

### 查询

#### 分页

分页问题

从传输效率上来考虑，该功能点必须在后端持久层实现

- jeesite开源版本pagination插件
  - 耦合严重，依赖mybatis拦截器功能。如果需要关闭该功能或切换ORM框架则改动较大。

> 半透明的封装是一件很糟糕的事。
>
> 这意味着它可能满足需求的某些场景，但是也可能不满足某些场景。特别是在文档不健全的情况下，是否符合需求需要程序员通过阅读 源码(烂代码，bad smell ,shits)去做调研。非常浪费时间与精力，而这往往并非工作重心。
>
> 个人以为，好的工具：要么完全透明，是开发的小斧头，小利器。学习简单，信手拈来；要么封装完善，能具体到需求80%的场景，应用简单，即使它实现起来要多复杂有多复杂，但大多数情况不需要人们关心底层实现，譬如Spring。
>
> 像jeesite这种全是bug的框架放到开源网站上，很让人怀疑其诚心或是其能力。

## 数据库

### 注意区分配置文件与数据库

比如`URL`这种信息，对于用户来讲是可见的，所以可通过配置文件或其他方式保存。

#### `URL`权限控制

通过配置文件或者代码等醒目的方式保存这种数据，比通过数据库保存开销小且更易于修改。

之所以通过数据库保存URL权限信息，大多是为了让用户可调整业务权限。

但是，调整“哪些业务对用户可见”的方式也可通过调整用户其角色实现。

> 在需求分析初期规定哪些业务可被哪些角色使用是最佳的一种方式。
>
> - 将未来可能的变动控制到最低，对开发人员来说是友好的
>
> - 不允许用户自己调整某项业务所需要的权限
>
>   - 确保对用户较低的打扰度
>
>   - 假设用户可以调整，用户也无法将权限控制到“按钮“级别，但程序员可以。即除非用户懂编程，否则调整业务权限对其是不可见的。
>
> - 假如业务权限常常变动，我们需要怀疑是否需业务本身不合理。即我们的需求分析没有做充足。

所以，***通过数据库来保存URL权限是不必要的。***

### 设计不合理往往产生更多的逻辑校验代码——bad smell

## tips

### 避免绝对路径

实在不明白为何同事们热衷于绝对路径。使用绝对路径至少在部署时很麻烦，比如:从windows到linux，需要多配置shell脚本或者bat脚本blablabla

需要明确一个系统中那些<key-value>是保存于数据库中或是配置文件中，意味着是否允许用户修改

# 测试

测试工程师根据测试用例编写测试代码用于快速地单元测试与集成测试。

### 好处

- 减少测试人员工作量，一次编写反复测试
- 当需求发生变更或引入新需求时，可通过代码检查是否影响系统其他功能正常工作
- 不论是产品特性存在问题，还是单元测试存在问题。由于两者相互映照，当出现分歧后，开发人员与测试人员可**及时**进行沟通以定位、分析和解决问题。

### 坏处

- 对测试人员素质要求高

# 管理

软件工程团队除了最著名的开发团队外，应当还有需求团队，测试团队，运维团队。(可能还有遗漏)

但就公司目前现状来看管理的是相当糟糕

- 团队职能不明。特别是缺少合格的需求团队，开发顶一会儿，测试顶一会儿，老板再顶一会儿。

- 开发模型不明。既不是传统瀑布流开发模型，也不是敏捷开发模型，也不是最新潮的TDD(测试驱动开发，我承认这个地方是我在卖弄)。既需要有传统模型的各种文档与流程，偏偏每个环节都无法做到好。既有敏捷开发过程中新旧需求不断更替，要求产品先行，又要刻板的遵照传统流程的各个步骤。

  开发模型不符合实际流程，导致开发周期一拖再拖。

  非核心功能本应当随版本更新步步迭代。却反复在需求未分析文档未更新情况下，任由开发人员凭自己的想像力开发。

- 沟通不足。

  某个项目由两位同事负责，开会时仅其中一位同事参加开会。这并非团队人数过多，而是由于团队缺乏沟通意识，没有认识到——一个项目的落地需要多方对项目**达成共识**。

  同时也是缺少一个有领导力、业务能力丰富、经验老道的项目牵头人。




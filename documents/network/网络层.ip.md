[toc]

# Overview

Internet Protocol是网络层协议。

# Concept

## IP Address

IP地址是互联网上用于标识主机（计算机、路由器等）的地址。它是一个32位的二进制数字，通常以IPv4地址表示，例如`172.18.21.79`。IPv4地址被分为四个八位字节，每个字节用十进制数表示，范围从0到255。

## Mask

子网掩码是一个32位的二进制数字，用于指示一个IP地址的网络部分和主机部分。子网掩码中的1表示网络部分，0表示主机部分。与IP地址进行按位与（AND）运算，可以得到该IP地址所在网络的地址。

### 示例

假设IP地址是`172.18.21.79`，子网掩码是`255.255.255.0`。将它们转换为二进制后进行AND运算：

- IP地址：`10101100 00010010 00010101 01001111`
- 子网掩码：`11111111 11111111 11111111 00000000`

按位与运算后得到网络地址：`10101100 00010010 00010101 00000000`，即`172.18.21.0`。

### 网络地址和主机地址

在IP地址中，网络地址部分用于标识一个网络，而主机地址部分用于标识该网络中的具体主机。

- 当主机地址为0时，表示整个网络。
- 当主机地址为255时，表示该网络的广播地址，用于向网络中的所有主机发送消息。

### 子网掩码的灵活性

子网掩码的长度不一定是8的倍数，它可以在字节的任何位置划分网络和主机部分。例如，`255.255.255.0`表示网络部分是24位，主机部分是8位。这种灵活性允许将IP地址空间划分为不同大小的子网，以适应网络的需求和规模。

## CIDR

在早期的互联网发展中，IP地址的分配和管理采用了一种基于类别的方法，被称为“有类”（Classful）地址分配。而后来随着互联网的发展和IP地址空间的枯竭，引入了一种更灵活的地址分配和路由选择方法，被称为“无类”（Classless）地址分配，也就是CIDR（Classless Inter-Domain Routing）。

### 有类地址分配

有类地址分配将IPv4地址空间分为几个固定的类别（A类、B类、C类等），每个类别分配给不同规模的网络使用。这些类别的地址范围和前缀长度是固定的，例如：

- A类地址范围：1.0.0.0 - 127.255.255.255
- B类地址范围：128.0.0.0 - 191.255.255.255
- C类地址范围：192.0.0.0 - 223.255.255.255

在有类地址分配中，IP地址的前几位用于表示网络号（网络部分），剩余的位数用于表示主机号（主机部分）。这种方法的缺点是，每个类别的地址范围是固定的，导致了地址空间的浪费。

### 无类地址分配（CIDR）

为了更有效地利用IP地址空间，CIDR引入了一种更灵活的地址分配和路由选择方法。CIDR将IP地址看作一个连续的地址空间，通过使用可变长度的子网掩码，允许将IP地址空间划分为更小的子网，使得更多的IP地址可以被分配到网络中。

CIDR采用了一种新的表示方法，将IP地址和子网掩码一起使用来表示网络的地址范围。例如，`192.168.1.0/24`表示一个包含了`192.168.1.0`到`192.168.1.255`之间所有IP地址的网络。

CIDR的引入改变了IP地址分配和路由选择的方式，使得互联网更加灵活、高效。现代的网络设备和路由器都支持CIDR，**并且互联网中的大多数IP地址都是按照CIDR方法分配的。**
[toc]

# 场景

- 异步处理
- 应用解耦
- 流量削峰
- 日志处理
- 消息通讯
- **分布式事务**

# 消息队列对比

| 消息中间件   | 性能   | 消息持久化 | 活跃度 | 优点                                         | 缺点                                                         |
| ------------ | ------ | ---------- | ------ | -------------------------------------------- | ------------------------------------------------------------ |
| Apache Kafka | 百万级 | 是         | 高     | 分布式、高吞吐量、可扩展、故障容错           | 配置和运维相对复杂；对Zookeeper强依赖；多副本机制对带宽要求高 |
| RocketMQ     | 十万级 | 是         | 中等   | 模型简单、接口易用                           | 社区支持不如Kafka和RabbitMQ                                  |
| RabbitMQ     | 12000+ | 是         | 高     | 支持多种消息协议、易于使用管理界面、成熟稳定 | 不支持动态扩展                                               |
| ActiveMQ     | 6000+  | 是         | 中等   | 成熟                                         | 社区支持不如Kafka和RabbitMQ                                  |

**补充说明：**

- **性能：** 表示每秒钟可以处理的消息数量，性能数字仅供参考，实际性能可能因部署环境、硬件配置和使用方式等因素而有所不同。
- **消息持久化：** 表示消息是否可以持久化存储，以确保即使在服务器故障时消息也不会丢失。
- **活跃度：** 表示社区活跃度和开发维护情况。

# AMQP

AMQP（Advanced Message Queuing Protocol）是一种应用层标准高级消息队列协议。

## 背景

不同厂家使用的消息队列（MQ）具有不同的API和协议，如果应用程序需要与不同厂家的消息队列进行通信，则可能增加系统的复杂性。为了解决这个问题，引入了AMQP作为消息通信的标准化方案。

## 基本概念

- **Server/Broker：** 实现AMQP的服务器实体。
- **Connection：** 应用程序与Broker之间的网络连接。
- **Channel：** 用于消息读写的通道，客户端可以建立多个Channel，每个Channel代表一个会话任务。
- **Message：** 消息的载体，包含发送和接收的数据。
- **Exchange：** 接收消息并将消息路由到一个或多个队列。
- **Binding：** Exchange与Queue之间的虚拟连接，用于消息路由。
- **Routing key：** 用于消息路由的虚拟地址。
- **Queue：** 消息队列，用于存储和转发消息。
- **Virtual Host：** 类似权限控制组，一个Virtual Host中可以包含多个Exchange和Queue。

